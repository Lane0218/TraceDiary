{
  "task_uid": "td_04aea2b157da4850f26b",
  "display_id": "TD-AUTH-002",
  "id_prefix": "AUTH",
  "module_key": "6.13",
  "module_name": "游客模式与账号体系（v1.2）",
  "module_label": "6.13 游客模式与账号体系（v1.2）",
  "order": 174,
  "status": "DONE",
  "title": "统一邮箱验证码流程并移除登录注册分叉",
  "acceptance": "邮箱验证码界面不再区分登录/注册模式，统一为单一 OTP 流程；保留“还没有账号？点击注册”入口但不引入独立注册状态；清理相关分叉代码与测试",
  "related_files": [
    "src/App.tsx",
    "src/components/auth/entry-auth-modal.tsx",
    "src/pages/auth-reset-password.tsx",
    "src/services/supabase.ts",
    "src/__tests__/integration/entry-auth-modal.integration.test.tsx",
    "src/__tests__/integration/app.integration.test.tsx",
    "src/__tests__/integration/app-entry-auth-transition.integration.test.tsx",
    "e2e/fixtures/app.ts",
    "todo/tasks/td_04aea2b157da4850f26b.json"
  ],
  "test_record": "风险分级：高（认证主链路 UI/状态机改造）。已将首登设置密码从 OTP 页内嵌小卡片改为独立步骤页：验证码首登成功后切换到 `setup-password` 视图，提供“设置密码并继续”主按钮与“先跳过，稍后设置”底部按钮，不再走“去设置密码”跳转卡片。新增/更新集成测试覆盖首登进入设置页、设置成功提交、两次密码不一致时禁止提交。已执行：`npm run lint` 通过；`npm run test:unit` 通过（95/95）；`npm run test:integration` 通过（93/93）；`npx playwright test e2e/specs/auth-setup.spec.ts e2e/specs/auth-session.spec.ts --project=chromium --retries=0 --reporter=line --trace=off` 通过（5/5）。",
  "done_record": "2026-02-23 / 15e408d",
  "source": {
    "file": "TODO.md",
    "line": 253
  },
  "version": 55,
  "updated_at": "2026-02-23T11:53:44.000Z"
}
